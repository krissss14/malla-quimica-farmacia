
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Interactiva - Química y Farmacia</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      padding: 20px;
    }
    .asignatura {
      padding: 10px 15px;
      margin: 5px;
      border-radius: 10px;
      display: inline-block;
      background-color: #ddd;
      cursor: pointer;
      transition: 0.3s;
      position: relative;
    }
    .asignatura input {
      border: none;
      background: transparent;
      width: 100%;
      text-align: center;
      font-size: 1em;
    }
    .aprobada {
      background-color: #a5d6a7;
      color: #000;
    }
    .disponible {
      background-color: #fff59d;
      color: #000;
    }
    .bloqueada {
      background-color: #e0e0e0;
      color: #888;
      pointer-events: none;
    }
    h1 {
      text-align: center;
    }
    .nivel {
      margin-bottom: 30px;
    }
    #reset {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      background: #ef5350;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva - Química y Farmacia</h1>
  <button id="reset" onclick="resetearProgreso()">Resetear progreso</button>
  <div id="malla"></div>

  <script>
    const asignaturas = {
      1: "Química General I",
      2: "Biología Celular",
      3: "Matemática I",
      4: "Anatomía y Embriología Humana",
      5: "Química General II",
      6: "Física General",
      7: "Matemática II",
      8: "Histología",
      10: "Electivo Formación General I",
      11: "Química Orgánica I",
      12: "Química Analítica",
      13: "Físicoquímica I",
      14: "Biología",
      16: "Electivo Formación General II",
      17: "Química Orgánica II",
      18: "Análisis Instrumental",
      19: "Fisicoquímica II",
      20: "Biomedicina I",
      21: "Laboratorio Química Orgánica",
      22: "Bioquímica General",
      23: "Fisiopatología I",
      24: "Microbiología",
      25: "Operaciones Unitarias",
      26: "Bromatología",
      30: "Farmacología I",
      31: "Farmacognosia I",
      32: "Salud Pública",
      33: "Bioquímica Clínica",
      34: "Farmacología II",
      35: "Farmacognosia II",
      36: "Farmacotécnica I",
      37: "Administración y Gestión",
      38: "Electivo Formación General III",
      39: "Farmacia Clínica I",
      40: "Tecnología Farmacéutica I",
      41: "Epidemiología y Estadística",
      42: "Desarrollo Farmacéutico y Educativo",
      45: "Farmacia Clínica II",
      46: "Nutrición Clínica",
      47: "Metodología de Investigación",
      48: "Legislación Farmacéutica",
      49: "Electivo de Especialidad I",
      50: "Internado Clínico",
      51: "Electivo de Especialidad II",
      52: "Electivo de Especialidad III",
      53: "Actividad de Titulación"
    };

    const prerrequisitos = {
      "5": ["1"], "6": ["3"], "7": ["3"], "8": ["2"],
      "11": ["5"], "12": ["5"], "13": ["6"], "14": ["2"],
      "17": ["11"], "18": ["12"], "19": ["13"], "20": ["14"], "21": ["11"],
      "22": ["17"], "23": ["20"], "24": ["8"], "25": ["18"], "26": ["19"],
      "30": ["23"], "31": ["22"], "32": ["22"], "33": ["22"],
      "34": ["30"], "35": ["31"], "36": ["25"], "37": ["25"],
      "39": ["34"], "40": ["36"], "41": ["32"], "42": ["33"],
      "45": ["39"], "46": ["39"], "47": ["41"], "48": ["40"], "49": ["40"],
      "50": ["45"], "51": ["49"], "52": ["49"], "53": ["50"]
    };

    function crearMalla() {
      const container = document.getElementById("malla");
      container.innerHTML = "";
      let niveles = {};

      for (let id in asignaturas) {
        const nivel = obtenerNivel(id);
        if (!niveles[nivel]) niveles[nivel] = [];
        niveles[nivel].push(id);
      }

      for (let nivel in niveles) {
        const divNivel = document.createElement("div");
        divNivel.classList.add("nivel");
        const titulo = document.createElement("h2");
        titulo.textContent = `Nivel ${nivel}`;
        divNivel.appendChild(titulo);

        niveles[nivel].forEach(id => {
          const div = document.createElement("div");
          const nombre = localStorage.getItem(`nombre_${id}`) || asignaturas[id];
          div.className = "asignatura";

          if (localStorage.getItem(`estado_${id}`) === "aprobada") {
            div.classList.add("aprobada");
          } else if (!prerrequisitos[id] || prerrequisitos[id].every(p => localStorage.getItem(`estado_${p}`) === "aprobada")) {
            div.classList.add("disponible");
            div.onclick = () => marcarAprobada(id);
          } else {
            div.classList.add("bloqueada");
          }

          const input = document.createElement("input");
          input.value = nombre;
          input.onblur = () => localStorage.setItem(`nombre_${id}`, input.value);
          div.appendChild(input);

          div.id = id;
          divNivel.appendChild(div);
        });

        container.appendChild(divNivel);
      }
    }

    function obtenerNivel(id) {
      const niveles = {
        1: 1, 2: 1, 3: 1, 4: 1,
        5: 2, 6: 2, 7: 2, 8: 2, 10: 2,
        11: 3, 12: 3, 13: 3, 14: 3, 16: 3,
        17: 4, 18: 4, 19: 4, 20: 4, 21: 4,
        22: 5, 23: 5, 24: 5, 25: 5, 26: 5,
        30: 6, 31: 6, 32: 6, 33: 6,
        34: 7, 35: 7, 36: 7, 37: 7, 38: 7,
        39: 8, 40: 8, 41: 8, 42: 8,
        45: 9, 46: 9, 47: 9, 48: 9, 49: 9,
        50: 10, 51: 10, 52: 10,
        53: 11
      };
      return niveles[id] || 99;
    }

    function marcarAprobada(id) {
      localStorage.setItem(`estado_${id}`, "aprobada");
      crearMalla();
    }

    function resetearProgreso() {
      Object.keys(localStorage).forEach(k => {
        if (k.startsWith("estado_") || k.startsWith("nombre_")) {
          localStorage.removeItem(k);
        }
      });
      crearMalla();
    }

    crearMalla();
  </script>
</body>
</html>
